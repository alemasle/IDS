#!/usr/bin/env python

import sys,urllib2,random,time

try:
    ip = sys.argv[1]
except IndexError:
    ip = '127.0.0.1'

def request(u):
    url = "http://%s/%s" % (ip, u)
    print "URL: %s" % url
    try:
        f = urllib2.urlopen(url)
    except urllib2.URLError as e:
        print e
    except urllib2.HTTPError as e:
        print e[0]
        sys.exit(1)

try:
    request('x?id=site1')
    time.sleep(1.337)
    request('x?id=../../../etc/passwd')
except KeyboardInterrupt:
    sys.exit(0)

# vim: ft=python:
